<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portfolio Dashboard - Ezana Finance</title>
  <!-- Inter Font from Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <link rel="stylesheet" href="../assets/css/theme-variables.css">
  <link rel="stylesheet" href="../assets/css/theme.css">
  <link rel="stylesheet" href="../assets/css/component-cards.css">
  <link rel="stylesheet" href="../assets/css/unified-component-cards.css">
  <link rel="stylesheet" href="../assets/css/universal-card-standards.css">
  <link rel="stylesheet" href="../assets/css/page-layout.css">
  <link rel="stylesheet" href="../assets/css/pages-common.css">
  <link rel="stylesheet" href="../assets/css/light-mode-fixes.css">
  <link rel="stylesheet" href="../components/navigation/unified-nav.css">
  <link rel="stylesheet" href="../components/notifications/notifications-sidebar.css">
  <link rel="stylesheet" href="../components/learning/learning-opportunities.css">
  <link rel="stylesheet" href="home-dashboard.css">
  <!-- Chart.js loaded lazily by home-dashboard.js when charts are needed -->
</head>
<body class="dashboard-page sidebar-open">
  <nav class="main-nav" id="mainNav"></nav>

  <!-- Notifications Sidebar (watchlist structure, dashboard design) -->
  <div id="notifications-sidebar" class="notifications-sidebar open">
    <button id="notifications-toggle" class="notifications-toggle" onclick="toggleNotificationsSidebar()">
      <i class="bi bi-bell"></i>
    </button>
    <div class="notifications-content">
      <div class="notifications-header">
        <div class="notifications-title">
          <h3>Investment Feed</h3>
        </div>
        <div class="notifications-actions">
          <button class="notifications-collapse" onclick="toggleSidebarCollapse()" title="Collapse Sidebar">
            <i class="bi bi-chevron-double-left"></i>
          </button>
          <button class="notifications-settings" onclick="openNotificationSettings()" title="Settings">
            <i class="bi bi-gear"></i>
          </button>
        </div>
      </div>
      <div class="notifications-filters">
        <button class="filter-btn active" data-filter="all" onclick="filterNotifications('all')">All</button>
        <button class="filter-btn" data-filter="congress" onclick="filterNotifications('congress')">Congress</button>
        <button class="filter-btn" data-filter="stocks" onclick="filterNotifications('stocks')">Stocks</button>
        <button class="filter-btn" data-filter="community" onclick="filterNotifications('community')">Community</button>
      </div>
      <div class="notifications-list" id="notifications-list"></div>
      <div class="notifications-empty" id="notifications-empty" style="display: none;">
        <i class="bi bi-bell-slash"></i>
        <p>No notifications yet</p>
        <small>We'll notify you when something important happens</small>
      </div>
    </div>
  </div>

  <!-- Main Dashboard Content -->
  <main class="dashboard-main">
    <div class="dashboard-container">

      <!-- Quick Actions Bar (50% thinner) -->
      <section class="quick-actions-bar compact">
        <button class="quick-action-btn" data-action="refresh"><i class="bi bi-arrow-clockwise"></i><span>Refresh</span></button>
        <button class="quick-action-btn" data-action="report"><i class="bi bi-file-earmark-text"></i><span>Report</span></button>
        <button class="quick-action-btn" data-action="analysis"><i class="bi bi-graph-up"></i><span>Analysis</span></button>
        <button class="quick-action-btn" data-action="alerts"><i class="bi bi-bell"></i><span>Alerts</span></button>
        <button class="quick-action-btn" data-action="watchlist"><i class="bi bi-bookmark"></i><span>Watchlist</span></button>
      </section>

      <!-- Metrics Carousel (50% thinner) -->
      <section class="metrics-carousel-section compact">
        <button class="carousel-nav prev" id="carouselPrev"><i class="bi bi-chevron-left"></i></button>
        <div class="metrics-carousel-container">
          <div class="metrics-carousel-track" id="metricsCarousel">
            <div class="metric-card active" data-metric="portfolio">
              <div class="metric-icon portfolio"><i class="bi bi-wallet2"></i></div>
              <div class="metric-content">
                <span class="metric-label">Portfolio Value</span>
                <span class="metric-value">$158,420</span>
                <span class="metric-change positive">+24.5% YTD</span>
              </div>
            </div>
            <div class="metric-card" data-metric="pnl">
              <div class="metric-icon pnl"><i class="bi bi-graph-up"></i></div>
              <div class="metric-content">
                <span class="metric-label">Today's P&L</span>
                <span class="metric-value">+$1,247</span>
              </div>
            </div>
            <div class="metric-card" data-metric="performer" data-symbol="NVDA">
              <div class="metric-icon performer"><i class="bi bi-star"></i></div>
              <div class="metric-content">
                <span class="metric-label">Top Performer</span>
                <span class="metric-value performer-value">NVDA</span>
                <span class="metric-change performer-change positive">â€”</span>
              </div>
            </div>
            <div class="metric-card" data-metric="risk">
              <div class="metric-icon risk"><i class="bi bi-shield-exclamation"></i></div>
              <div class="metric-content">
                <span class="metric-label">Risk Score</span>
                <span class="metric-value">6.2/10</span>
              </div>
            </div>
            <div class="metric-card" data-metric="dividends">
              <div class="metric-icon dividends"><i class="bi bi-cash-coin"></i></div>
              <div class="metric-content">
                <span class="metric-label">Monthly Dividends</span>
                <span class="metric-value">$847</span>
              </div>
            </div>
            <div class="metric-card" data-metric="allocation">
              <div class="metric-icon allocation"><i class="bi bi-pie-chart"></i></div>
              <div class="metric-content">
                <span class="metric-label">Asset Allocation</span>
                <span class="metric-value">Balanced</span>
              </div>
            </div>
            <div class="metric-card" data-metric="volatility">
              <div class="metric-icon volatility"><i class="bi bi-activity"></i></div>
              <div class="metric-content">
                <span class="metric-label">Volatility</span>
                <span class="metric-value">4.8/10</span>
              </div>
            </div>
            <div class="metric-card" data-metric="beta">
              <div class="metric-icon beta"><i class="bi bi-arrow-down-up"></i></div>
              <div class="metric-content">
                <span class="metric-label">Beta vs Market</span>
                <span class="metric-value">1.05</span>
              </div>
            </div>
            <div class="metric-card" data-metric="sector">
              <div class="metric-icon sector"><i class="bi bi-building"></i></div>
              <div class="metric-content">
                <span class="metric-label">Sector Exposure</span>
                <span class="metric-value">Tech 35%</span>
              </div>
            </div>
          </div>
        </div>
        <button class="carousel-nav next" id="carouselNext"><i class="bi bi-chevron-right"></i></button>
      </section>

      <!-- Main Content Grid -->
      <div class="dashboard-grid">
        <!-- Main Chart (2/3 width) - Line chart or Allocation pie when Allocation metric selected -->
        <section class="main-chart-section">
          <div class="chart-header compact">
            <div class="chart-title-area">
              <h2 class="chart-title" id="chartTitle">Total Portfolio Value</h2>
            </div>
            <div class="chart-controls" id="chartControls">
              <div class="time-range-selector compact" id="timeRangeSelector">
                <button class="time-btn" data-range="1D">1D</button>
                <button class="time-btn" data-range="1W">1W</button>
                <button class="time-btn" data-range="1M">1M</button>
                <button class="time-btn active" data-range="3M">3M</button>
                <button class="time-btn" data-range="6M">6M</button>
                <button class="time-btn" data-range="1Y">1Y</button>
              </div>
              <select class="filter-select allocation-timeframe-select" id="allocationTimeframe" style="display: none;">
                <option value="current">Current</option>
                <option value="1m">1 Month Ago</option>
                <option value="3m">3 Months Ago</option>
                <option value="1y">1 Year Ago</option>
              </select>
            </div>
          </div>
          <div class="chart-container compact" id="lineChartContainer">
            <canvas id="mainChart"></canvas>
          </div>
          <!-- Asset Allocation pie chart - shown when Allocation metric card is selected in carousel -->
          <div class="allocation-chart-view" id="allocationChartView" style="display: none;">
            <div class="allocation-chart-container">
              <svg id="allocationPieChart" viewBox="0 0 400 400" class="allocation-pie-chart">
                <!-- Pie chart rendered by asset-allocation.js -->
              </svg>
              <div class="chart-center-label">
                <div class="total-label">Total Portfolio</div>
                <div class="total-value">$158,420</div>
              </div>
              <div class="sector-tooltip" id="sectorTooltip">
                <div class="tooltip-header">
                  <div class="sector-name"></div>
                  <div class="sector-percentage"></div>
                </div>
                <div class="tooltip-body">
                  <div class="sector-value"></div>
                  <div class="holdings-title">Top 5 Holdings:</div>
                  <div class="holdings-list"></div>
                </div>
              </div>
            </div>
            <div class="allocation-legend" id="allocationLegend"></div>
          </div>
        </section>

        <!-- Portfolio News Sidebar (1/3 width) -->
        <section class="portfolio-news-sidebar">
          <div class="news-header">
            <h3>Relevant Portfolio News</h3>
            <i class="bi bi-newspaper"></i>
          </div>
          <div class="news-ticker-wrapper">
            <div class="news-ticker" id="newsTicker">
            <div class="news-insight">
              <div class="insight-icon positive"><i class="bi bi-arrow-up-circle"></i></div>
              <div class="insight-content">
                <p class="insight-text">Yesterday your portfolio jumped by 0.45%. That's the 10th highest one-day jump ever.</p>
                <span class="insight-time">Yesterday</span>
              </div>
            </div>
            <div class="news-insight">
              <div class="insight-icon warning"><i class="bi bi-exclamation-triangle"></i></div>
              <div class="insight-content">
                <p class="insight-text">Your portfolio's tech exposure increased to 35% this week. Consider rebalancing.</p>
                <span class="insight-time">2 days ago</span>
              </div>
            </div>
            <div class="news-insight">
              <div class="insight-icon info"><i class="bi bi-lightbulb"></i></div>
              <div class="insight-content">
                <p class="insight-text">NVDA has gained 12.4% this week. It's now your top performer for Q4.</p>
                <span class="insight-time">3 days ago</span>
              </div>
            </div>
            <div class="news-insight">
              <div class="insight-icon positive"><i class="bi bi-trophy"></i></div>
              <div class="insight-content">
                <p class="insight-text">Your portfolio beat the S&P 500 by 2.2% this quarter. Great job!</p>
                <span class="insight-time">1 week ago</span>
              </div>
            </div>
            <div class="news-insight">
              <div class="insight-icon warning"><i class="bi bi-cash-stack"></i></div>
              <div class="insight-content">
                <p class="insight-text">You'll receive $847 in dividend payments next week from 5 holdings.</p>
                <span class="insight-time">1 week ago</span>
              </div>
            </div>
            <div class="news-insight">
              <div class="insight-icon info"><i class="bi bi-graph-down"></i></div>
              <div class="insight-content">
                <p class="insight-text">Your portfolio volatility decreased to 4.8. You're below market average.</p>
                <span class="insight-time">2 weeks ago</span>
              </div>
            </div>
          </div>
          </div>
        </section>
      </div>

      <!-- Additional Component Cards -->
      <div class="additional-components-grid">
        <section class="component-card transactions-card">
          <div class="card-header">
            <h3>Recent Transactions</h3>
            <button class="card-action-btn">View All</button>
          </div>
          <p class="card-description">Track your latest buys and sells with timestamps and amounts.</p>
          <div class="card-body">
            <div class="transaction-list">
              <div class="transaction-item buy">
                <div class="transaction-icon"><i class="bi bi-arrow-up-circle"></i></div>
                <div class="transaction-details">
                  <div class="transaction-name">NVDA</div>
                  <div class="transaction-meta">Bought 10 shares</div>
                </div>
                <div class="transaction-amount">
                  <div class="amount">$4,850.00</div>
                  <div class="date">Today, 2:30 PM</div>
                </div>
              </div>
              <div class="transaction-item sell">
                <div class="transaction-icon"><i class="bi bi-arrow-down-circle"></i></div>
                <div class="transaction-details">
                  <div class="transaction-name">TSLA</div>
                  <div class="transaction-meta">Sold 5 shares</div>
                </div>
                <div class="transaction-amount">
                  <div class="amount">$1,245.50</div>
                  <div class="date">Yesterday, 10:15 AM</div>
                </div>
              </div>
              <div class="transaction-item buy">
                <div class="transaction-icon"><i class="bi bi-arrow-up-circle"></i></div>
                <div class="transaction-details">
                  <div class="transaction-name">AAPL</div>
                  <div class="transaction-meta">Bought 15 shares</div>
                </div>
                <div class="transaction-amount">
                  <div class="amount">$2,730.00</div>
                  <div class="date">2 days ago</div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="component-card holdings-card">
          <div class="card-header">
            <h3>Top Holdings</h3>
            <button class="card-action-btn">Manage</button>
          </div>
          <p class="card-description">Your largest positions ranked by portfolio allocation percentage.</p>
          <div class="card-body">
            <div class="holdings-list">
              <div class="holding-item" data-symbol="NVDA" data-shares="150">
                <div class="holding-rank">1</div>
                <div class="holding-info">
                  <div class="holding-name">NVDA</div>
                  <div class="holding-shares">150 shares</div>
                </div>
                <div class="holding-value">
                  <div class="value holding-value-display">$72,850</div>
                  <div class="change holding-change-display positive">+12.4%</div>
                </div>
                <div class="holding-allocation">
                  <div class="allocation-bar"><div class="allocation-fill" style="width: 28%"></div></div>
                  <span class="allocation-percent">28%</span>
                </div>
              </div>
              <div class="holding-item" data-symbol="AAPL" data-shares="200">
                <div class="holding-rank">2</div>
                <div class="holding-info">
                  <div class="holding-name">AAPL</div>
                  <div class="holding-shares">200 shares</div>
                </div>
                <div class="holding-value">
                  <div class="value holding-value-display">$36,400</div>
                  <div class="change holding-change-display positive">+5.2%</div>
                </div>
                <div class="holding-allocation">
                  <div class="allocation-bar"><div class="allocation-fill" style="width: 18%"></div></div>
                  <span class="allocation-percent">18%</span>
                </div>
              </div>
              <div class="holding-item" data-symbol="MSFT" data-shares="85">
                <div class="holding-rank">3</div>
                <div class="holding-info">
                  <div class="holding-name">MSFT</div>
                  <div class="holding-shares">85 shares</div>
                </div>
                <div class="holding-value">
                  <div class="value holding-value-display">$32,045</div>
                  <div class="change holding-change-display positive">+3.8%</div>
                </div>
                <div class="holding-allocation">
                  <div class="allocation-bar"><div class="allocation-fill" style="width: 15%"></div></div>
                  <span class="allocation-percent">15%</span>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="component-card performance-card">
          <div class="card-header">
            <h3>Performance Summary</h3>
            <select class="time-select">
              <option>This Month</option>
              <option>This Quarter</option>
              <option>This Year</option>
            </select>
          </div>
          <p class="card-description">See how your portfolio performed over different time periods with key metrics.</p>
          <div class="card-body">
            <div class="performance-metrics">
              <div class="perf-metric">
                <div class="perf-label">Total Return</div>
                <div class="perf-value positive">+8.4%</div>
                <div class="perf-comparison">vs S&P 500: +6.2%</div>
              </div>
              <div class="perf-metric">
                <div class="perf-label">Total Gain/Loss</div>
                <div class="perf-value positive">+$12,847</div>
                <div class="perf-comparison">+6.8% of initial investment</div>
              </div>
              <div class="perf-metric">
                <div class="perf-label">Best Day</div>
                <div class="perf-value">+$2,145</div>
                <div class="perf-comparison">December 15, 2025</div>
              </div>
              <div class="perf-metric">
                <div class="perf-label">Dividend Income</div>
                <div class="perf-value">$2,541</div>
                <div class="perf-comparison">+12% vs last period</div>
              </div>
            </div>
          </div>
        </section>
        <section class="component-card alerts-card">
          <div class="card-header">
            <h3>Alerts & Recommendations</h3>
            <span class="alert-count">3 New</span>
          </div>
          <p class="card-description">Smart notifications for rebalancing, opportunities, and important events.</p>
          <div class="card-body">
            <div class="alerts-list">
              <div class="alert-item high">
                <div class="alert-priority"><i class="bi bi-exclamation-circle"></i></div>
                <div class="alert-content">
                  <div class="alert-title">Rebalancing Suggested</div>
                  <div class="alert-message">Your tech allocation (35%) exceeds target (30%). Consider reducing exposure.</div>
                </div>
                <button class="alert-action">Review</button>
              </div>
              <div class="alert-item medium">
                <div class="alert-priority"><i class="bi bi-lightbulb"></i></div>
                <div class="alert-content">
                  <div class="alert-title">Buy Opportunity</div>
                  <div class="alert-message">AAPL is down 3.2% today. Good entry point based on your strategy.</div>
                </div>
                <button class="alert-action">View</button>
              </div>
              <div class="alert-item low">
                <div class="alert-priority"><i class="bi bi-info-circle"></i></div>
                <div class="alert-content">
                  <div class="alert-title">Dividend Payment</div>
                  <div class="alert-message">You'll receive $847 in dividends on October 15th from 5 holdings.</div>
                </div>
                <button class="alert-action">Details</button>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- Learning Opportunities -->
      <section class="learning-opportunities">
        <div class="learning-header">
          <div class="learning-title-area">
            <div class="learning-icon"><i class="bi bi-mortarboard-fill"></i></div>
            <div class="learning-title-text">
              <h3>Portfolio Management Courses</h3>
              <p>Master the skills to optimize your portfolio performance</p>
            </div>
          </div>
          <button class="view-all-btn" onclick="window.location.href='learning-center.html'">View All Courses <i class="bi bi-arrow-right"></i></button>
        </div>
        <div class="courses-grid">
          <div class="course-card">
            <div class="course-header">
              <span class="course-type">Course</span>
              <span class="course-duration"><i class="bi bi-clock"></i> 4 hours</span>
            </div>
            <h4 class="course-title">Portfolio Management Fundamentals</h4>
            <p class="course-description">Learn the core principles of portfolio construction, asset allocation, and rebalancing strategies.</p>
            <div class="course-meta">
              <div class="meta-item"><i class="bi bi-book"></i> <span>12 lessons</span></div>
              <div class="meta-item"><i class="bi bi-people"></i> <span>2,341 enrolled</span></div>
            </div>
            <div class="course-footer">
              <span class="course-level beginner">Beginner</span>
              <button class="enroll-btn">Enroll Now</button>
            </div>
          </div>
          <div class="course-card">
            <div class="course-header">
              <span class="course-type">Course</span>
              <span class="course-duration"><i class="bi bi-clock"></i> 6 hours</span>
            </div>
            <h4 class="course-title">Risk Management Strategies</h4>
            <p class="course-description">Master advanced risk management techniques including hedging, stop-losses, and portfolio insurance.</p>
            <div class="course-meta">
              <div class="meta-item"><i class="bi bi-book"></i> <span>18 lessons</span></div>
              <div class="meta-item"><i class="bi bi-people"></i> <span>1,847 enrolled</span></div>
            </div>
            <div class="course-footer">
              <span class="course-level intermediate">Intermediate</span>
              <button class="enroll-btn">Enroll Now</button>
            </div>
          </div>
          <div class="course-card">
            <div class="course-header">
              <span class="course-type">Skill</span>
              <span class="course-duration"><i class="bi bi-clock"></i> 3 hours</span>
            </div>
            <h4 class="course-title">Understanding Volatility</h4>
            <p class="course-description">Deep dive into market volatility, VIX analysis, and how to profit from volatile markets.</p>
            <div class="course-meta">
              <div class="meta-item"><i class="bi bi-book"></i> <span>8 lessons</span></div>
              <div class="meta-item"><i class="bi bi-people"></i> <span>1,523 enrolled</span></div>
            </div>
            <div class="course-footer">
              <span class="course-level intermediate">Intermediate</span>
              <button class="enroll-btn">Enroll Now</button>
            </div>
          </div>
          <div class="course-card">
            <div class="course-header">
              <span class="course-type">Skill</span>
              <span class="course-duration"><i class="bi bi-clock"></i> 5 hours</span>
            </div>
            <h4 class="course-title">Sector Rotation &amp; Allocation</h4>
            <p class="course-description">Learn how to rotate between sectors based on economic cycles and market conditions.</p>
            <div class="course-meta">
              <div class="meta-item"><i class="bi bi-book"></i> <span>15 lessons</span></div>
              <div class="meta-item"><i class="bi bi-people"></i> <span>1,289 enrolled</span></div>
            </div>
            <div class="course-footer">
              <span class="course-level advanced">Advanced</span>
              <button class="enroll-btn">Enroll Now</button>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <script src="../assets/js/theme-toggle.js" defer></script>
  <script src="../assets/js/finnhub-api.js" defer></script>
  <script src="../components/navigation/load-nav.js" defer></script>
  <script src="../components/notifications/notifications-sidebar.js" defer></script>
  <script src="../js/api-service.js" defer></script>
  <script src="../assets/js/asset-allocation.js" defer></script>
  <script src="home-dashboard.js" defer></script>
  <script defer>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('../sw.js', { scope: '../' }).then(function() {}).catch(function() {});
      });
    }
  </script>
</body>
</html>
