<div class="container mx-auto px-6 py-12">
    <div class="mb-12">
        <h1 class="text-4xl font-light text-foreground tracking-tight mb-4">Financial Analytics</h1>
        <p class="text-lg text-muted-foreground">Comprehensive analysis of your financial health and spending patterns</p>
    </div>

    <!-- Financial Health Score -->
    <div class="bg-card rounded-2xl p-8 border border-border mb-12">
        <div class="flex items-center justify-between mb-8">
            <h3 class="text-2xl font-medium text-foreground">Financial Health Score</h3>
            <button onclick="refreshFinancialHealth()" class="px-6 py-3 bg-primary hover:bg-opacity-90 text-primary-foreground rounded-xl transition-colors">
                <i class="bi bi-arrow-clockwise mr-2"></i>Refresh
            </button>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Health Score Display -->
            <div class="text-center">
                <div class="relative w-40 h-40 mx-auto mb-6">
                    <svg class="w-40 h-40 transform -rotate-90" viewBox="0 0 120 120">
                        <circle cx="60" cy="60" r="54" stroke="#022C5A" stroke-width="8" fill="none"></circle>
                        <circle id="health-score-circle" cx="60" cy="60" r="54" stroke="#B5A01A" stroke-width="8" fill="none" 
                                stroke-dasharray="339.292" stroke-dashoffset="203.575" stroke-linecap="round"></circle>
                    </svg>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <div class="text-center">
                            <div id="health-score-value" class="text-4xl font-light text-foreground">8.7</div>
                            <div class="text-sm text-muted-foreground">/ 10</div>
                        </div>
                    </div>
                </div>
                <div id="health-level" class="text-xl font-medium text-primary">Excellent</div>
                <div class="text-sm text-muted-foreground mt-2">Financial Health Level</div>
            </div>
            
            <!-- Health Components -->
            <div class="lg:col-span-2 space-y-4">
                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-emerald-100 dark:bg-emerald-900 rounded-full flex items-center justify-center">
                            <i class="bi bi-piggy-bank text-emerald-600 dark:text-emerald-400"></i>
                        </div>
                        <div>
                            <div class="font-medium text-gray-900 dark:text-white">Savings Rate</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Monthly savings percentage</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div id="savings-rate" class="text-xl font-bold text-emerald-600 dark:text-emerald-400">23.5%</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">Score: <span id="savings-score">94/100</span></div>
                    </div>
                </div>
                
                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center">
                            <i class="bi bi-shield-check text-blue-600 dark:text-blue-400"></i>
                        </div>
                        <div>
                            <div class="font-medium text-gray-900 dark:text-white">Emergency Fund</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Months of expenses covered</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div id="emergency-fund" class="text-xl font-bold text-blue-600 dark:text-blue-400">5.2 months</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">Score: <span id="emergency-score">87/100</span></div>
                    </div>
                </div>
                
                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center">
                            <i class="bi bi-wallet2 text-purple-600 dark:text-purple-400"></i>
                        </div>
                        <div>
                            <div class="font-medium text-gray-900 dark:text-white">Total Balance</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Across all accounts</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div id="total-balance" class="text-xl font-bold text-purple-600 dark:text-purple-400">$58,830</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">Score: <span id="balance-score">85/100</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bank Connections -->
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 mb-8">
        <div class="flex items-center justify-between mb-6">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Connected Bank Accounts</h3>
            <button onclick="connectBankAccount()" class="px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg transition-colors">
                <i class="bi bi-plus mr-2"></i>Connect Account
            </button>
        </div>
        
        <div id="bank-connections" class="space-y-4">
            <!-- Sample bank connection -->
            <div class="flex items-center justify-between p-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg border border-emerald-200 dark:border-emerald-700">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center">
                        <i class="bi bi-bank text-white text-xl"></i>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-900 dark:text-gray-100">Chase Bank</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">3 accounts connected â€¢ Last sync: 2 hours ago</div>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="w-2 h-2 bg-emerald-500 rounded-full"></span>
                    <span class="text-sm text-emerald-600 dark:text-emerald-400">Connected</span>
                    <button onclick="importTransactions(1)" class="ml-4 px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded text-sm transition-colors">
                        Import Transactions
                    </button>
                </div>
            </div>
            
            <div class="text-center py-8 text-gray-500 dark:text-gray-400 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg">
                <i class="bi bi-bank text-4xl mb-4"></i>
                <p class="mb-2">Connect more bank accounts for better insights</p>
                <button onclick="connectBankAccount()" class="text-emerald-600 hover:text-emerald-700 font-medium">
                    Add Another Bank
                </button>
            </div>
        </div>
    </div>

    <!-- Spending Analysis -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
        <!-- Spending by Category -->
        <div class="card card-content">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">Spending by Category (Last 30 Days)</h3>
            
            <div class="space-y-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-4 h-4 bg-red-500 rounded"></div>
                        <span class="text-gray-900 dark:text-white">Groceries</span>
                    </div>
                    <div class="text-right">
                        <div class="font-semibold text-gray-900 dark:text-white">$1,245.67</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">32.1%</div>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-4 h-4 bg-blue-500 rounded"></div>
                        <span class="text-gray-900 dark:text-white">Dining</span>
                    </div>
                    <div class="text-right">
                        <div class="font-semibold text-gray-900 dark:text-white">$867.43</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">22.4%</div>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-4 h-4 bg-emerald-500 rounded"></div>
                        <span class="text-gray-900 dark:text-white">Transportation</span>
                    </div>
                    <div class="text-right">
                        <div class="font-semibold text-gray-900 dark:text-white">$543.21</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">14.0%</div>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-4 h-4 bg-yellow-500 rounded"></div>
                        <span class="text-gray-900 dark:text-white">Utilities</span>
                    </div>
                    <div class="text-right">
                        <div class="font-semibold text-gray-900 dark:text-white">$432.89</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">11.2%</div>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-4 h-4 bg-purple-500 rounded"></div>
                        <span class="text-gray-900 dark:text-white">Entertainment</span>
                    </div>
                    <div class="text-right">
                        <div class="font-semibold text-gray-900 dark:text-white">$321.45</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">8.3%</div>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                <div class="flex justify-between items-center">
                    <span class="font-medium text-gray-900 dark:text-white">Total Spending</span>
                    <span class="text-xl font-bold text-gray-900 dark:text-white">$3,876.54</span>
                </div>
                <div class="flex justify-between items-center mt-2">
                    <span class="text-sm text-gray-600 dark:text-gray-400">Daily Average</span>
                    <span class="text-sm font-medium text-gray-900 dark:text-white">$129.22</span>
                </div>
            </div>
        </div>

        <!-- Income vs Expenses -->
        <div class="card card-content">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">Income vs Expenses</h3>
            
            <div class="space-y-6">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-emerald-100 dark:bg-emerald-900 rounded-full flex items-center justify-center">
                            <i class="bi bi-arrow-up text-emerald-600 dark:text-emerald-400"></i>
                        </div>
                        <div>
                            <div class="font-medium text-gray-900 dark:text-white">Monthly Income</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">After tax income</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-2xl font-bold text-emerald-600 dark:text-emerald-400">$5,200.00</div>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center">
                            <i class="bi bi-arrow-down text-red-600 dark:text-red-400"></i>
                        </div>
                        <div>
                            <div class="font-medium text-gray-900 dark:text-white">Monthly Expenses</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Total spending</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-2xl font-bold text-red-600 dark:text-red-400">$3,876.54</div>
                    </div>
                </div>
                
                <div class="flex items-center justify-between p-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg border border-emerald-200 dark:border-emerald-700">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-emerald-500 rounded-full flex items-center justify-center">
                            <i class="bi bi-plus text-white"></i>
                        </div>
                        <div>
                            <div class="font-medium text-gray-900 dark:text-gray-100">Net Savings</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Income - Expenses</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-2xl font-bold text-emerald-600 dark:text-emerald-400">$1,323.46</div>
                        <div class="text-sm text-emerald-600 dark:text-emerald-400">25.4% savings rate</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Investment Recommendations -->
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 mb-8">
        <div class="flex items-center justify-between mb-6">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Personalized Investment Recommendations</h3>
            <div class="flex items-center space-x-2">
                <select id="risk-tolerance" onchange="updateInvestmentRecommendations()" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-gray-200">
                    <option value="conservative">Conservative</option>
                    <option value="moderate" selected>Moderate</option>
                    <option value="aggressive">Aggressive</option>
                </select>
                <button onclick="refreshRecommendations()" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors">
                    Refresh
                </button>
            </div>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="investment-recommendations">
            <!-- VTI Recommendation -->
            <div class="p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-emerald-500 transition-colors">
                <div class="flex items-center justify-between mb-3">
                    <div class="font-semibold text-gray-900 dark:text-white">VTI</div>
                    <div class="text-right">
                        <div class="text-lg font-bold text-emerald-600 dark:text-emerald-400">40%</div>
                        <div class="text-xs text-gray-600 dark:text-gray-400">Allocation</div>
                    </div>
                </div>
                <div class="mb-2">
                    <div class="text-sm font-medium text-gray-900 dark:text-white">Vanguard Total Stock Market ETF</div>
                    <div class="text-xs text-gray-600 dark:text-gray-400">Expected Return: 7-10%</div>
                </div>
                <div class="text-xs text-gray-600 dark:text-gray-400 mb-2">
                    Balanced growth with diversification
                </div>
                <div class="flex items-center space-x-2">
                    <span class="px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 text-xs rounded">ETF</span>
                    <span class="px-2 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300 text-xs rounded">Medium Risk</span>
                </div>
            </div>
            
            <!-- BND Recommendation -->
            <div class="p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-blue-500 transition-colors">
                <div class="flex items-center justify-between mb-3">
                    <div class="font-semibold text-gray-900 dark:text-white">BND</div>
                    <div class="text-right">
                        <div class="text-lg font-bold text-blue-600 dark:text-blue-400">30%</div>
                        <div class="text-xs text-gray-600 dark:text-gray-400">Allocation</div>
                    </div>
                </div>
                <div class="mb-2">
                    <div class="text-sm font-medium text-gray-900 dark:text-white">Vanguard Total Bond Market ETF</div>
                    <div class="text-xs text-gray-600 dark:text-gray-400">Expected Return: 3-6%</div>
                </div>
                <div class="text-xs text-gray-600 dark:text-gray-400 mb-2">
                    Income generation and stability
                </div>
                <div class="flex items-center space-x-2">
                    <span class="px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 text-xs rounded">ETF</span>
                    <span class="px-2 py-1 bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 text-xs rounded">Low Risk</span>
                </div>
            </div>
            
            <!-- VXUS Recommendation -->
            <div class="p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-purple-500 transition-colors">
                <div class="flex items-center justify-between mb-3">
                    <div class="font-semibold text-gray-900 dark:text-white">VXUS</div>
                    <div class="text-right">
                        <div class="text-lg font-bold text-purple-600 dark:text-purple-400">20%</div>
                        <div class="text-xs text-gray-600 dark:text-gray-400">Allocation</div>
                    </div>
                </div>
                <div class="mb-2">
                    <div class="text-sm font-medium text-gray-900 dark:text-white">Vanguard Total International Stock ETF</div>
                    <div class="text-xs text-gray-600 dark:text-gray-400">Expected Return: 6-9%</div>
                </div>
                <div class="text-xs text-gray-600 dark:text-gray-400 mb-2">
                    International diversification
                </div>
                <div class="flex items-center space-x-2">
                    <span class="px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 text-xs rounded">ETF</span>
                    <span class="px-2 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300 text-xs rounded">Medium Risk</span>
                </div>
            </div>
            
            <!-- VNQ Recommendation -->
            <div class="p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-orange-500 transition-colors">
                <div class="flex items-center justify-between mb-3">
                    <div class="font-semibold text-gray-900 dark:text-white">VNQ</div>
                    <div class="text-right">
                        <div class="text-lg font-bold text-orange-600 dark:text-orange-400">10%</div>
                        <div class="text-xs text-gray-600 dark:text-gray-400">Allocation</div>
                    </div>
                </div>
                <div class="mb-2">
                    <div class="text-sm font-medium text-gray-900 dark:text-white">Vanguard Real Estate Investment Trust ETF</div>
                    <div class="text-xs text-gray-600 dark:text-gray-400">Expected Return: 5-8%</div>
                </div>
                <div class="text-xs text-gray-600 dark:text-gray-400 mb-2">
                    Real estate exposure and inflation hedge
                </div>
                <div class="flex items-center space-x-2">
                    <span class="px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 text-xs rounded">ETF</span>
                    <span class="px-2 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300 text-xs rounded">Medium Risk</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Financial Recommendations -->
    <div class="card card-content">
        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">Personalized Recommendations</h3>
        
        <div class="space-y-4" id="financial-recommendations">
            <div class="flex items-start space-x-4 p-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg border border-emerald-200 dark:border-emerald-700">
                <div class="w-8 h-8 bg-emerald-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <i class="bi bi-check-circle text-white"></i>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-900 dark:text-gray-100">Excellent Savings Rate</h4>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Your 25.4% savings rate is well above the recommended 20%. Keep up the great work!</p>
                </div>
            </div>
            
            <div class="flex items-start space-x-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700">
                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <i class="bi bi-info-circle text-white"></i>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-900 dark:text-gray-100">Consider Tax-Advantaged Accounts</h4>
                    <p class="text-sm text-gray-600 dark:text-gray-400">With your strong savings rate, consider maximizing contributions to 401(k) and IRA accounts for tax benefits.</p>
                </div>
            </div>
            
            <div class="flex items-start space-x-4 p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-700">
                <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <i class="bi bi-lightbulb text-white"></i>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-900 dark:text-gray-100">Optimize Investment Allocation</h4>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Consider rebalancing your portfolio quarterly to maintain your target asset allocation.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Bank Connection Modal -->
<div id="bank-connection-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full">
            <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                <div class="flex justify-between items-center">
                    <h2 class="text-xl font-bold text-gray-900 dark:text-white">Connect Bank Account</h2>
                    <button onclick="closeBankConnectionModal()" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                        <i class="bi bi-x-lg text-xl"></i>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <form onsubmit="submitBankConnection(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Bank Name</label>
                            <select id="bank-name" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-emerald-500 dark:bg-gray-700 dark:text-gray-200" required>
                                <option value="">Select your bank</option>
                                <option value="Chase Bank">Chase Bank</option>
                                <option value="Bank of America">Bank of America</option>
                                <option value="Wells Fargo">Wells Fargo</option>
                                <option value="Citibank">Citibank</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Connection Token</label>
                            <input type="text" id="bank-token" placeholder="Enter your bank connection token" 
                                   class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-emerald-500 dark:bg-gray-700 dark:text-white" required>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">For demo purposes, enter any value</p>
                        </div>
                        
                        <div class="flex space-x-3 pt-4">
                            <button type="button" onclick="closeBankConnectionModal()" class="flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                Cancel
                            </button>
                            <button type="submit" class="flex-1 px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg transition-colors">
                                Connect
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
