<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Company Research - Ezana Finance</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <link rel="stylesheet" href="../assets/css/theme-variables.css">
  <link rel="stylesheet" href="../assets/css/theme.css">
  <link rel="stylesheet" href="../assets/css/component-cards.css">
  <link rel="stylesheet" href="../assets/css/unified-component-cards.css">
  <link rel="stylesheet" href="../assets/css/universal-card-standards.css">
  <link rel="stylesheet" href="../assets/css/page-layout.css">
  <link rel="stylesheet" href="../assets/css/pages-common.css">
  <link rel="stylesheet" href="../assets/css/layout-common.css">
  <link rel="stylesheet" href="../assets/css/light-mode-fixes.css">
  <link rel="stylesheet" href="../components/navigation/unified-nav.css">
  <link rel="stylesheet" href="../components/notifications/notifications-sidebar.css">
  <link rel="stylesheet" href="../components/learning/learning-opportunities.css">
  <link rel="stylesheet" href="company-research.css">
</head>
<body class="dashboard-page sidebar-open">

  <nav class="main-nav" id="mainNav"></nav>

  <div id="notifications-sidebar" class="notifications-sidebar open">
    <button id="notifications-toggle" class="notifications-toggle" onclick="toggleNotificationsSidebar()"><i class="bi bi-bell"></i></button>
    <div class="notifications-content">
      <div class="notifications-header">
        <div class="notifications-title"><h3>Investment Feed</h3></div>
        <div class="notifications-actions">
          <button class="notifications-collapse" onclick="toggleSidebarCollapse()" title="Collapse"><i class="bi bi-chevron-double-left"></i></button>
          <button class="notifications-settings" onclick="openNotificationSettings()" title="Settings"><i class="bi bi-gear"></i></button>
        </div>
      </div>
      <div class="notifications-filters">
        <button class="filter-btn active" data-filter="all" onclick="filterNotifications('all')">All</button>
        <button class="filter-btn" data-filter="congress" onclick="filterNotifications('congress')">Congress</button>
        <button class="filter-btn" data-filter="stocks" onclick="filterNotifications('stocks')">Stocks</button>
        <button class="filter-btn" data-filter="community" onclick="filterNotifications('community')">Community</button>
      </div>
      <div class="notifications-list" id="notifications-list"></div>
      <div class="notifications-empty" id="notifications-empty" style="display:none;"><i class="bi bi-bell-slash"></i><p>No notifications yet</p><small>We'll notify you when something important happens</small></div>
    </div>
  </div>

  <div class="page-wrapper sidebar-active">
    <main class="page-content">

      <!-- Company Search Bar -->
      <div class="company-search-wrapper">
        <div class="search-container">
          <i class="bi bi-search"></i>
          <input type="text" id="companySearchInput" placeholder="Search company or ticker (e.g., NVDA, Apple Inc.)" class="company-search-input" autocomplete="off">
          <button class="search-btn" id="searchCompanyBtn"><i class="bi bi-arrow-right"></i></button>
        </div>
        <div class="search-suggestions" id="searchSuggestions"></div>
      </div>

      <!-- Stats Grid (populated when a stock is selected) -->
      <div class="stats-grid" id="companyStatsGrid">
        <div class="stat-card" id="stat-mcap">
          <div class="stat-icon market"><i class="bi bi-building"></i></div>
          <div class="stat-content">
            <div class="stat-value" id="statMarketCap">--</div>
            <div class="stat-label">Market Cap</div>
            <div class="stat-change" id="statCapType">--</div>
          </div>
        </div>
        <div class="stat-card" id="stat-pe">
          <div class="stat-icon performance"><i class="bi bi-trophy"></i></div>
          <div class="stat-content">
            <div class="stat-value" id="statPE">--</div>
            <div class="stat-label">P/E Ratio</div>
            <div class="stat-change" id="statPELabel">--</div>
          </div>
        </div>
        <div class="stat-card" id="stat-divyield">
          <div class="stat-icon stocks"><i class="bi bi-cash-coin"></i></div>
          <div class="stat-content">
            <div class="stat-value" id="statDivYield">--</div>
            <div class="stat-label">Dividend Yield</div>
            <div class="stat-change" id="statDivYieldLabel">--</div>
          </div>
        </div>
        <div class="stat-card" id="stat-eps">
          <div class="stat-icon volume"><i class="bi bi-graph-up-arrow"></i></div>
          <div class="stat-content">
            <div class="stat-value" id="statEPS">--</div>
            <div class="stat-label">EPS</div>
            <div class="stat-change" id="statEPSLabel">--</div>
          </div>
        </div>
      </div>

      <!-- Financial Analysis Models Carousel (dashboard metric-card style) -->
      <section class="models-carousel-section compact">
        <button class="carousel-nav prev" id="modelsCarouselPrev" type="button"><i class="bi bi-chevron-left"></i></button>
        <div class="models-carousel-container">
          <div class="models-carousel-track" id="modelsCarouselTrack">
            <div class="model-metric-card model-card" data-model="dcf">
              <div class="model-metric-icon dcf"><i class="bi bi-cash-stack"></i></div>
              <div class="model-metric-content">
                <span class="model-metric-label">DCF Valuation</span>
                <span class="model-metric-value">5-year projections</span>
                <span class="model-metric-change">Select to run</span>
              </div>
            </div>
            <div class="model-metric-card model-card" data-model="three-statement">
              <div class="model-metric-icon three-statement"><i class="bi bi-file-earmark-spreadsheet"></i></div>
              <div class="model-metric-content">
                <span class="model-metric-label">Three-Statement</span>
                <span class="model-metric-value">Linked statements</span>
                <span class="model-metric-change">Select to run</span>
              </div>
            </div>
            <div class="model-metric-card model-card" data-model="ma-accretion">
              <div class="model-metric-icon ma"><i class="bi bi-arrow-left-right"></i></div>
              <div class="model-metric-content">
                <span class="model-metric-label">M&A Accretion</span>
                <span class="model-metric-value">Merger impact</span>
                <span class="model-metric-change">Select to run</span>
              </div>
            </div>
            <div class="model-metric-card model-card" data-model="lbo">
              <div class="model-metric-icon lbo"><i class="bi bi-diagram-3"></i></div>
              <div class="model-metric-content">
                <span class="model-metric-label">LBO Model</span>
                <span class="model-metric-value">Leveraged buyout</span>
                <span class="model-metric-change">Select to run</span>
              </div>
            </div>
            <div class="model-metric-card model-card" data-model="comps">
              <div class="model-metric-icon comps"><i class="bi bi-list-check"></i></div>
              <div class="model-metric-content">
                <span class="model-metric-label">Comparable Cos</span>
                <span class="model-metric-value">Trading multiples</span>
                <span class="model-metric-change">Select to run</span>
              </div>
            </div>
            <div class="model-metric-card model-card" data-model="precedent">
              <div class="model-metric-icon precedent"><i class="bi bi-clock-history"></i></div>
              <div class="model-metric-content">
                <span class="model-metric-label">Precedent Txns</span>
                <span class="model-metric-value">M&A comparables</span>
                <span class="model-metric-change">Select to run</span>
              </div>
            </div>
            <div class="model-metric-card model-card" data-model="ipo">
              <div class="model-metric-icon ipo"><i class="bi bi-graph-up-arrow"></i></div>
              <div class="model-metric-content">
                <span class="model-metric-label">IPO Valuation</span>
                <span class="model-metric-value">Offering pricing</span>
                <span class="model-metric-change">Select to run</span>
              </div>
            </div>
            <div class="model-metric-card model-card" data-model="credit">
              <div class="model-metric-icon credit"><i class="bi bi-shield-check"></i></div>
              <div class="model-metric-content">
                <span class="model-metric-label">Credit Analysis</span>
                <span class="model-metric-value">Debt capacity</span>
                <span class="model-metric-change">Select to run</span>
              </div>
            </div>
            <div class="model-metric-card model-card" data-model="sotp">
              <div class="model-metric-icon sotp"><i class="bi bi-pie-chart"></i></div>
              <div class="model-metric-content">
                <span class="model-metric-label">Sum-of-Parts</span>
                <span class="model-metric-value">Segment valuation</span>
                <span class="model-metric-change">Select to run</span>
              </div>
            </div>
            <div class="model-metric-card model-card" data-model="operating">
              <div class="model-metric-icon operating"><i class="bi bi-gear"></i></div>
              <div class="model-metric-content">
                <span class="model-metric-label">Operating Model</span>
                <span class="model-metric-value">Unit economics</span>
                <span class="model-metric-change">Select to run</span>
              </div>
            </div>
            <div class="model-metric-card model-card" data-model="sensitivity">
              <div class="model-metric-icon sensitivity"><i class="bi bi-shuffle"></i></div>
              <div class="model-metric-content">
                <span class="model-metric-label">Sensitivity</span>
                <span class="model-metric-value">Scenario planning</span>
                <span class="model-metric-change">Select to run</span>
              </div>
            </div>
            <div class="model-metric-card model-card" data-model="investment-memo">
              <div class="model-metric-icon memo"><i class="bi bi-file-earmark-text"></i></div>
              <div class="model-metric-content">
                <span class="model-metric-label">Investment Memo</span>
                <span class="model-metric-value">Full analysis</span>
                <span class="model-metric-change">Select to run</span>
              </div>
            </div>
          </div>
        </div>
        <button class="carousel-nav next" id="modelsCarouselNext" type="button"><i class="bi bi-chevron-right"></i></button>
      </section>

      <!-- Market Heatmap / Stock Chart Card -->
      <section class="market-chart-section" id="marketChartSection">
        <!-- HEATMAP VIEW (default) -->
        <div id="heatmapView">
          <div class="chart-header compact">
            <div class="chart-title-area">
              <h2 class="chart-title">Stock Market Heatmap</h2>
              <span class="heatmap-subtitle">S&P 500 &middot; Performance YTD % &middot; Market Cap</span>
            </div>
          </div>
          <div class="heatmap-container" id="heatmapContainer">
            <div class="chart-loading" id="heatmapLoading">
              <i class="bi bi-arrow-repeat spin"></i>
              <span>Loading heatmap...</span>
            </div>
          </div>
        </div>

        <!-- STOCK CHART VIEW (shown when a stock is selected) -->
        <div id="stockChartView" style="display:none;">
          <div class="chart-header compact">
            <div class="chart-title-area">
              <h2 class="chart-title" id="stockChartTitle">--</h2>
              <div class="market-chart-meta" id="stockChartMeta">
                <span class="market-price" id="stockPrice">--</span>
                <span class="market-change" id="stockChange">--</span>
              </div>
            </div>
            <div class="chart-controls">
              <button class="back-to-heatmap-btn" id="backToHeatmap"><i class="bi bi-grid-3x3-gap"></i> Heatmap</button>
              <div class="time-range-selector compact" id="stockTimeRange">
                <button class="time-btn" data-range="1D">1D</button>
                <button class="time-btn" data-range="1W">1W</button>
                <button class="time-btn active" data-range="1M">1M</button>
                <button class="time-btn" data-range="3M">3M</button>
                <button class="time-btn" data-range="6M">6M</button>
                <button class="time-btn" data-range="1Y">1Y</button>
              </div>
            </div>
          </div>
          <div class="chart-container compact" id="stockChartContainer">
            <div class="chart-loading" id="stockChartLoading">
              <i class="bi bi-arrow-repeat spin"></i>
              <span>Loading stock data...</span>
            </div>
            <canvas id="stockChart"></canvas>
          </div>
          <div class="market-chart-footer" id="stockChartFooter">
            <div class="market-stat">
              <span class="market-stat-label">Open</span>
              <span class="market-stat-value" id="mstatOpen">--</span>
            </div>
            <div class="market-stat">
              <span class="market-stat-label">High</span>
              <span class="market-stat-value" id="mstatHigh">--</span>
            </div>
            <div class="market-stat">
              <span class="market-stat-label">Low</span>
              <span class="market-stat-value" id="mstatLow">--</span>
            </div>
            <div class="market-stat">
              <span class="market-stat-label">Volume</span>
              <span class="market-stat-value" id="mstatVolume">--</span>
            </div>
            <div class="market-stat">
              <span class="market-stat-label">Prev Close</span>
              <span class="market-stat-value" id="mstatPrevClose">--</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Model Detail Section (scroll target when model selected from carousel) -->
      <section class="model-detail-section" id="modelDetailSection" style="display:none;">
        <div class="component-card model-detail-card">
          <div class="card-header">
            <h3 id="modelDetailTitle">Financial Analysis Model</h3>
            <button class="card-action-btn" id="modelDetailClose" type="button"><i class="bi bi-x-lg"></i> Close</button>
          </div>
          <div class="model-detail-body" id="modelDetailBody">
            <!-- DCF form or other model UI injected here -->
          </div>
        </div>
      </section>

      <!-- Company Info Panel (hidden until search, populated by FMP) -->
      <div id="companyInfoPanel" style="display:none;" class="company-info-panel">
        <div class="company-info-grid">
          <div class="company-info-main">
            <div class="company-header-row">
              <img id="companyLogo" src="" alt="" class="company-logo" style="display:none;">
              <div>
                <h2 id="companyName">--</h2>
                <span id="companySector" class="company-sector-badge">--</span>
                <span id="companyExchange" class="company-exchange-badge">--</span>
              </div>
            </div>
            <p id="companyDescription" class="company-description">Search for a company to see its details.</p>
          </div>
          <div class="company-info-sidebar">
            <div class="info-row"><span class="info-label">CEO</span><span id="companyCEO" class="info-value">--</span></div>
            <div class="info-row"><span class="info-label">Employees</span><span id="companyEmployees" class="info-value">--</span></div>
            <div class="info-row"><span class="info-label">IPO Date</span><span id="companyIPODate" class="info-value">--</span></div>
            <div class="info-row"><span class="info-label">52W High</span><span id="company52High" class="info-value">--</span></div>
            <div class="info-row"><span class="info-label">52W Low</span><span id="company52Low" class="info-value">--</span></div>
            <div class="info-row"><span class="info-label">Div Yield</span><span id="companyDivYield" class="info-value">--</span></div>
            <div class="info-row"><span class="info-label">DCF Value</span><span id="companyDCF" class="info-value">--</span></div>
            <div class="info-row"><span class="info-label">Analyst Rating</span><span id="companyRating" class="info-value">--</span></div>
          </div>
        </div>
        <div id="companyFinancials" class="company-financials-section" style="display:none;">
          <h3><i class="bi bi-table"></i> Key Financial Metrics</h3>
          <div class="financials-table-wrap" id="financialsTableWrap"></div>
        </div>
        <div id="companyPeers" class="company-peers-section" style="display:none;">
          <h3><i class="bi bi-people"></i> Peer Companies</h3>
          <div class="peers-list" id="peersList"></div>
        </div>
      </div>

      <!-- Learning Opportunities -->
      <section class="learning-opportunities">
        <div class="learning-header">
          <div class="learning-title-area">
            <div class="learning-icon"><i class="bi bi-mortarboard-fill"></i></div>
            <div class="learning-title-text">
              <h3>Fundamental Analysis Mastery</h3>
              <p>Deep dive into financial statement analysis and valuation</p>
            </div>
          </div>
          <button class="view-all-btn" onclick="window.location.href='learning-center.html'">View All Courses</button>
        </div>
        <div class="courses-grid">
          <div class="course-card">
            <div class="course-header"><span class="course-type">Course</span><span class="course-duration"><i class="bi bi-clock"></i> 6 hours</span></div>
            <h4 class="course-title">Financial Statement Analysis</h4>
            <p class="course-description">Master reading and analyzing income statements, balance sheets, and cash flow statements.</p>
            <div class="course-meta"><div class="meta-item"><i class="bi bi-book"></i> 20 lessons</div><div class="meta-item"><i class="bi bi-people"></i> 3,241 enrolled</div></div>
            <div class="course-footer"><span class="course-level intermediate">Intermediate</span><button class="enroll-btn">Enroll Now</button></div>
          </div>
          <div class="course-card">
            <div class="course-header"><span class="course-type">Course</span><span class="course-duration"><i class="bi bi-clock"></i> 8 hours</span></div>
            <h4 class="course-title">Valuation Methods & DCF Modeling</h4>
            <p class="course-description">Learn to build discounted cash flow models and understand various valuation methodologies.</p>
            <div class="course-meta"><div class="meta-item"><i class="bi bi-book"></i> 24 lessons</div><div class="meta-item"><i class="bi bi-people"></i> 2,847 enrolled</div></div>
            <div class="course-footer"><span class="course-level advanced">Advanced</span><button class="enroll-btn">Enroll Now</button></div>
          </div>
          <div class="course-card">
            <div class="course-header"><span class="course-type">Skill</span><span class="course-duration"><i class="bi bi-clock"></i> 4 hours</span></div>
            <h4 class="course-title">Earnings Call Analysis</h4>
            <p class="course-description">Learn to extract insights from quarterly earnings calls and management guidance.</p>
            <div class="course-meta"><div class="meta-item"><i class="bi bi-book"></i> 14 lessons</div><div class="meta-item"><i class="bi bi-people"></i> 1,923 enrolled</div></div>
            <div class="course-footer"><span class="course-level intermediate">Intermediate</span><button class="enroll-btn">Enroll Now</button></div>
          </div>
          <div class="course-card">
            <div class="course-header"><span class="course-type">Course</span><span class="course-duration"><i class="bi bi-clock"></i> 5 hours</span></div>
            <h4 class="course-title">Competitive Analysis Frameworks</h4>
            <p class="course-description">Master Porter's Five Forces, SWOT analysis, and competitive positioning strategies.</p>
            <div class="course-meta"><div class="meta-item"><i class="bi bi-book"></i> 18 lessons</div><div class="meta-item"><i class="bi bi-people"></i> 2,134 enrolled</div></div>
            <div class="course-footer"><span class="course-level beginner">Beginner</span><button class="enroll-btn">Enroll Now</button></div>
          </div>
        </div>
      </section>

    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
  <script src="../js/api-config.js" defer></script>
  <script src="../assets/js/api-cache.js" defer></script>
  <script src="../assets/js/alpha-vantage-api.js" defer></script>
  <script src="../assets/js/fmp-api.js" defer></script>
  <script src="../assets/js/news-api.js" defer></script>
  <script src="../assets/js/market-data-service.js" defer></script>
  <script src="../assets/js/theme-toggle.js" defer></script>
  <script src="../components/navigation/load-nav.js" defer></script>
  <script src="../components/notifications/notifications-sidebar.js" defer></script>
  <script src="company-research.js" defer></script>
  <script defer>
    if (window.NotificationsSidebar) new NotificationsSidebar().init();
  </script>
</body>
</html>
